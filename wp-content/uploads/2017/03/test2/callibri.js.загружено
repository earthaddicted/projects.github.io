function callibridomain(){var a,b,c="";return a=document.domain.split("."),a.length>2?(b="www"===a[0]&&a.length>3?2:1,!0===_callibri.allow_subdomains&&(b-=1),c=(_callibri.allow_subdomains?"":".")+a.slice(b,a.length).toString().replace(/,/g,".")):c=(_callibri.allow_subdomains?"":".")+document.domain,c}function callibriSetCookieDomain(a,b,c,d,e){"session"!==c?(void 0===e?c.setMinutes(c.getMinutes()+10):c.setDate(c.getDate()+100),c=";expires="+c.toUTCString()+";"):c="",document.cookie=a+"="+escape(b)+"; path=/; "+d+" "+c}function callibriSetCookie(a,b,c,d,e){var f=callibridomain();"session"!==e&&(e=e?new Date((new Date).getTime()+24*e*60*60*1e3):new Date);var g=_callibri.allow_subdomains?"":"domain="+f+";";d||callibriSetCookieDomain(a,b,e,g,c),(-1===document.cookie.indexOf(a)||d)&&(g="",callibriSetCookieDomain(a,b,e,g,c))}function callibriGetCookie(a){var b,c,d,e=document.cookie.split(";");for(b=0;b<e.length;b++)if(c=e[b].substr(0,e[b].indexOf("=")),d=e[b].substr(e[b].indexOf("=")+1),(c=c.replace(/^\s+|\s+$/g,""))==a)return unescape(d);return!1}function XhrRequest(){for(var a,b=[function(){return a=checkIE8_9()?new XDomainRequest:new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=0;c<b.length;c++){try{a=b[c]()}catch(a){continue}break}return a}function callibriMakeRequest(a,b,c,d,e,f){try{var g,h,i,j,k;b=b||{};try{f=f||3e4}catch(a){f=3e4}if(!(i=XhrRequest()))return;if(a.match(/contactus$/)){b.ymclid=getMetrikaClientID(!0),b.gaclid=callibriGetGaClientID(!0);var l=callibriSetPostDataFeedback(b);i.feedback_data=l}if(e||(e=_callibri.server_host),h=document.location.protocol+"//"+e+a,i.open("POST",h,!0),k=checkIE8_9(),g=setTimeout(function(){i.abort()},f),k)i.onload=function(){i.feedback_data&&callibriRemoveElementItemLocalStorage("callibri_feedbacks",i.feedback_data),c&&"function"==typeof c&&c(i.responseText,200)};else{try{d=d||"application/json"}catch(a){d="application/json"}i.setRequestHeader("Content-Type",d),j=document.characterSet?document.characterSet:document.charset,"utf-8"!==j.toString().toLowerCase()?i.setRequestHeader("Accept",d+"; charset="+j):i.setRequestHeader("Accept",d),i.onreadystatechange=function(){3!=i.readyState&&4!=i.readyState||!i.feedback_data||204!=i.status&&422!=i.status||callibriRemoveElementItemLocalStorage("callibri_feedbacks",i.feedback_data),4==i.readyState&&(clearTimeout(g),c&&"function"==typeof c&&c(i.responseText,i.status)),4==i.readyState&&(0===i.status||500==i.status||i.status>=400)&&_callibri.server_host!==e&&callibriMakeRequest(a,b,c,d,null,f)}}var m=JSON.stringify(b);_callibri.btr||i.send(m)}catch(a){}}function supports_callibri_storage(){if(_callibri.localStorage_off)return!1;try{return localStorage.setItem("test_localstorage","1"),localStorage.removeItem("test_localstorage"),!0}catch(a){return _callibri.localStorage_off=!0,!1}}function callibriGetItemLocalStorage(a){return supports_callibri_storage()?localStorage.getItem(a):callibriGetCookie(a)}function callibriSetItemStorage(a,b){var c=!0;try{localStorage.setItem(a,b)}catch(a){_callibri.localStorage_off=!0,c=!1}return c}function callibriSetItemLocalStorage(a,b){var c=!0;if(supports_callibri_storage())if(b){var d=callibriSetItemStorage(a,b);d&&(c=!1)}else localStorage.removeItem(a);c&&callibriSetCookie(a,b)}function callibriRemoveElementItemLocalStorage(a,b){var c,d=callibriGetItemLocalStorage(a),e=[];d=d?JSON.parse(d):[];for(var f=0;f<d.length;f++)c=d[f],b!==c&&e.push(c);e=e.length>0?JSON.stringify(e):"",callibriSetItemLocalStorage(a,JSON.stringify(e))}function callibriSetPostDataFeedback(a){var b="";for(var c in a.feedback)c&&"number"!==c&&"session_id"!==c&&(b+=c+"-:-"+a.feedback[c].toString()+"-;-");var d=callibriGetItemLocalStorage("callibri_feedbacks");return d=d?JSON.parse(d):[],"object"!=typeof d&&(d=[]),-1===d.indexOf(b)&&(d.push(b),callibriSetItemLocalStorage("callibri_feedbacks",JSON.stringify(d))),b}function callibriSetLocalHooksUrl(a){if(a.data.module_settings&&a.data.module_settings.hooks_urls)try{_callibri.exists_url=!0,callibriSetItemLocalStorage("callibri_hooks_urls",JSON.stringify(a.data.module_settings.hooks_urls)),callibriSetItemLocalStorage("callibri_hooks_urls_timestamp",(new Date).toString()),delete a.data.module_settings.hooks_urls}catch(a){}return a}function callibriReplacePhones(a){var b=_callibri.objects.callibri.format;if(!a){for(var c=_callibri.objects.callibri.block_class.split(","),d=0;d<c.length;d++){callibriSetValueToBlocksByClass("."+c[d].replace(/\s/g,""),_callibri.number,b)}if(_callibri.module_settings&&_callibri.module_settings.elements){var e,f=_callibri.module_settings.elements,g=f.length;for(d=0;d<g;d++)e=f[d],callibriSetValueToBlocksByClass(e.element,_callibri.number,e.format)}}_callibri.module_settings&&_callibri.module_settings.elements&&(b=_callibri.module_settings.elements.map(function(a){if("#callibri-widget-header-phone"===a.element)return a.format})[0],callibriSetValueToBlocksByClass("#callibri-widget-header-phone",_callibri.number,b))}function callibriReplaceCopiesPhones(){if(_callibri.copies_phones){var a,b,c,d,e,f=_callibri.copies_phones.length;for(a=0;a<f;a++)for(b=_callibri.copies_phones[a],c=b.elements.length,d=0;d<c;d++)e=b.elements[d],callibriSetValueToBlocksByClass(e.element,b.phone,e.format)}}function callibriPingCallback(a){4==a.readyState&&201!==a.status&&(callibri_ping_interval&&(clearInterval(callibri_ping_interval),callibri_ping_interval=void 0),_callibri.ping_attempt?_callibri.ping_attempt+=1:_callibri.ping_attempt=1,setTimeout(callibriPingNumber,Math.floor(Math.random()*Math.pow(2,_callibri.ping_attempt)*1e3))),4==a.readyState&&201===a.status&&"undefined"==typeof callibri_ping_interval&&(callibri_ping_interval=setInterval(callibriPingNumber,1e4),_callibri.ping_attempt=null)}function callibriDocumentHidden(){var a;return void 0!==document.hidden?a="hidden":void 0!==document.msHidden?a="msHidden":void 0!==document.mozHidden?a="mozHidden":void 0!==document.webkitHidden&&(a="webkitHidden"),document[a]}function callibriPingNumber(){if(!callibriDocumentHidden()){var a=_callibri.number;if(_callibri.copies_phones){var b,c=_callibri.copies_phones.length;for(b=0;b<c;b++)a+="_"+_callibri.copies_phones[b].phone}var d="/visit?s="+_callibri.session_id+"&p="+a,e=getMetrikaClientID();e&&(d=d+"&y="+e);var f=callibriGetGaClientID();f&&(d=d+"&g="+f),callibriGetRequest("//ws."+_callibri.server_host+d,callibriPingCallback)}}function callibriSetLocalCookieValue(a,b){var c=callibriGetCookie(_callibri.cookie_prefix+"data"),d=JSON.parse(c);d.data[a]=b,d=JSON.stringify(d),callibriSetCookie(_callibri.cookie_prefix+"data",d,void 0,!0)}function callibriHandleResponse(a,b){try{var c,d;if(200!=b)return;if(a=checkIE8_9()?a.replace(/\\'/g,"'"):a,d=JSON.parse(a),void 0===d.data||"object"!=typeof d.data||"object"==typeof d.errors){"string"==typeof d.errors&&(d.errors=[[d.errors]]);for(var e in d.errors){var f="callibri error: "+d.errors[e].join(", ");void 0!==console?console.log(f):window.console.log(f)}return}if("object"==typeof d.data&&d.data.number&&!d.data.only_widget&&"object"!=typeof d.errors){extend(_callibri,d.data),c=d.data.number,d.data.session_id&&callibriSetCookie(_callibri.cookie_prefix+"sessions_callibri",d.data.session_id,1);var g=callibriGetCookie(_callibri.cookie_prefix+"data");d.data.dynamic&&(callibriSetItemLocalStorage("callibri_phone",_callibri.number),d.data.copies_phones&&callibriSetItemLocalStorage("callibri_copies_phones",JSON.stringify(d.data.copies_phones)),_callibri.init||(supports_callibri_storage()&&(window.addEventListener("storage",function(a){"callibri_phone"==a.key&&a.newValue&&a.oldValue!==a.newValue&&(_callibri.number=a.newValue,callibriSetLocalCookieValue("number",a.newValue),callibriReplacePhones())}),d.data.copies_phones&&window.addEventListener("storage",function(a){"callibri_copies_phones"==a.key&&a.newValue&&a.oldValue!==a.newValue&&(_callibri.copies_phones=JSON.parse(a.newValue),callibriSetLocalCookieValue("copies_phones",_callibri.copies_phones),callibriReplaceCopiesPhones())})),d.data.ping&&(g&&callibriPingNumber(),callibri_ping_interval=setInterval(callibriPingNumber,1e4)))),g||(d.expire_date=(new Date).toString(),d=callibriSetLocalHooksUrl(d),a=JSON.stringify(d),escape(a).length>3e3?(response_cookie=JSON.parse(a),response_cookie.data.module_settings="",response_cookie=JSON.stringify(response_cookie),callibriSetCookie(_callibri.cookie_prefix+"data",response_cookie,void 0,!0),supports_callibri_storage()&&callibriSetItemStorage("callibri_module_settings",JSON.stringify(d.data.module_settings))):callibriSetCookie(_callibri.cookie_prefix+"data",a,void 0,!0)),g=callibriGetCookie(_callibri.cookie_prefix+"data"),!g&&supports_callibri_storage()&&callibriSetItemStorage("callibri",a);for(var h=_callibri.objects.callibri,i=h.block_class.split(","),j=0;j<i.length;j++){callibriSetValueToBlocksByClass("."+i[j].replace(/\s/g,""),c,h.format)}if(!_callibri.init&&d.data.webcalls){var k=_callibri.widget_path||"//cdn.callibri.ru/widget.min.js";callibriGetLibrary(k,function(){callibriInitWidget()},"callibriWidget")}if(d.data.module_settings&&"string"==typeof d.data.module_settings.elements&&(d.data.module_settings.elements=JSON.parse(d.data.module_settings.elements)),d.data.module_settings&&d.data.module_settings.elements)for(elements=d.data.module_settings.elements,j=0;j<elements.length;j++)element=elements[j],callibriSetValueToBlocksByClass(element.element,c,element.format);var l=d.data.copies_phones;if(void 0!==l&&null!==l)for(var m=0;m<l.length;m++)if(copy=l[m],copy.element_class)callibriSetValueToBlocksByClass("."+copy.element_class,copy.phone,h.format);else{var n,o,p=copy.elements?copy.elements.length:0;for(n=0;n<p;n++)o=copy.elements[n],callibriSetValueToBlocksByClass(o.element,copy.phone,o.format)}callibriUseFeedback(),callibriChangeEmails(),_callibri.init||callibriGetGuid()}else if(d.data.module_settings){if(extend(_callibri,d.data),d.data.session_id&&(callibriSetCookie(_callibri.cookie_prefix+"sessions_callibri",d.data.session_id,1),callibriUseFeedback(),callibriChangeEmails()),supports_callibri_storage()&&(d.expire_date=(new Date).toString(),a=JSON.stringify(d),callibriSetItemStorage("callibri",a)),_callibri.init||void 0===d.data.module_settings.tabs||null===d.data.module_settings.tabs)return;d=callibriSetLocalHooksUrl(d);var k=_callibri.widget_path||"//cdn.callibri.ru/widget.min.js";callibriGetLibrary(k,function(){callibriInitWidget()},"callibriWidget"),_callibri.init||callibriGetGuid()}}catch(a){void 0!==console?console.log(a.stack):window.console.log(a),callibriSendError(a,"callibriHandleResponse")}_callibri.init=!0,callibriAfterResponse()}function callibriUseFeedback(){if(_callibri.use_feedback){if(callibriInitFormParser(),!_callibri.init&&_callibri.module_settings&&_callibri.module_settings.parser_init)try{"function"==typeof jQuery&&_callibri.module_settings.parser_init.jquery?jQuery("body").on("click",_callibri.module_settings.parser_init.button,function(){setTimeout(function(){callibriFormParserSearch(0)},2e3)}):callibriSearchFormButton()}catch(a){}callibriIframeMessage()}}function callibriSearchFormButton(){for(var a,b=document.querySelectorAll(_callibri.module_settings.parser_init.button),c=0;c<b.length;c++)a=b[c],"true"!=a.dataset.callibri_search_form&&(a.addEventListener("click",function(a){setTimeout(function(){callibriFormParserSearch(0)},2e3),a.target.removeEventListener("click",arguments.callee,!0),a.target.dataset.callibri_search_form=!1},!0),a.dataset.callibri_search_form=!0)}function callibriIframeMessage(){try{if(_callibri.module_settings&&_callibri.module_settings.iframe_selector){var a=document.querySelector(_callibri.module_settings.iframe_selector);a.contentWindow.postMessage(callibriGetCookie(_callibri.cookie_prefix+"data"),a.src)}}catch(a){}}function callibriFormParserSearch(a){for(var b=!0,c=document.querySelectorAll(_callibri.module_settings.parser_init.selector_forms),d=0;d<c.length;d++)if(null===c[d].querySelector("[data-callibri_parse_form]")){callibriInitFormParser(),b=!1;break}b&&a<15?(a+=1,setTimeout(function(){callibriFormParserSearch(a)},2e3)):callibriSearchFormButton()}function callibriInitFormParser(){if(_callibri.feedback_settings&&void 0===_callibri.feedback_settings.length)try{callibriFormSettings()}catch(a){}else callibriFormsOnSubmit(_callibri.objects.callibri,_callibri)}function callibriCollectionHas(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1}function callibriFindParentSelector(a,b){for(var c=document.querySelectorAll(b),d=a.parentNode;d&&!callibriCollectionHas(c,d);)d=d.parentNode;return d}function removeClass(a,b){for(var c=0;c<a.length;c++)a[c].className.toString().match(b)&&(a[c].className=a[c].className.replace(b,""))}function callibriFormSettings(){function a(a){if(13==a.keyCode||"keydown"!=a.type){callibri_send_feedback_form(callibriFindParentSelector(a.target,a.target.dataset.callibri_parse_form),a.target.dataset.callibri_parse_form)&&(a.target.removeEventListener("keydown",arguments.callee,!0),_callibri.mobile.isMobile&&(a.target.removeEventListener("click",arguments.callee,!0),a.target.removeEventListener("touchstart",arguments.callee,!0)),a.target.removeEventListener("mousedown",arguments.callee,!0))}}function b(a){try{var b=a.target,c=b.querySelector("*[data-callibri_parse_form]").dataset.callibri_parse_form,d=_callibri.feedback_settings[c],e=callibri_get_module_feedback_data(b,d);(e.feedback.email.length>0||e.feedback.phone.length>0)&&(callibriSetPostDataFeedback(e),a.target.removeEventListener("submit",arguments.callee,!0))}catch(a){}}var c,d,e,f,g,h,i;for(e in _callibri.feedback_settings){d=_callibri.feedback_settings[e],c=document.querySelectorAll(e),i=c.length;for(var j=0;j<i;j++)if(f=c[j],h=d.button,h&&(g=f.querySelectorAll(h)),(!h||h&&0===g.length)&&(g=f.querySelectorAll("input[type='submit']")[0]||f.querySelectorAll("button[type='submit']")[0]||f.querySelectorAll("button[id*=submit]")[0]||f.querySelectorAll("button")[0]||f.querySelectorAll(".button")[0]||f.querySelectorAll("input[name='submit']")[0]||void 0,g=[g]),_callibri.module_settings&&_callibri.module_settings.submit_form_key&&_callibri.module_settings.submit_form_key.indexOf(e)>-1){if(d.phone||d.email){f.addEventListener("submit",b,!0);for(var k=0;k<g.length;k++){var l=g[k];l.dataset.callibri_parse_form=e}}}else{for(var k=0;k<g.length;k++){var l=g[k];l&&!l.dataset.callibri_parse_form&&(d.phone||d.email)&&(l.dataset.callibri_parse_form=e,l.addEventListener("keydown",a,!0),_callibri.mobile.isMobile&&(l.addEventListener("click",a,!0),l.addEventListener("touchstart",a,!0)),l.addEventListener("mousedown",a,!0))}try{"FORM"!==f.tagName&&(f=f.querySelector("form")),f&&f.addEventListener("submit",b,!0)}catch(a){}}}}function callibri_get_module_feedback_data(a,b){var c={feedback:{name:"",phone:"",email:"",message:"",client_id:_callibri.site_id,number:_callibri.number,session_id:_callibri.session_id,page:document.location.protocol+"//"+document.location.host+document.location.pathname}};for(var d in b)if("button"!==d){value=b[d];try{element=a.querySelector(value)}catch(a){element=null}element&&(c.feedback[d]=element.value)}return c}function callibriFeedbackFormName(a){var b=a.dataset.callibri_form_name;if(!b){var c=a.querySelector("*[data-callibri_form_name]");b=c?c.dataset.callibri_form_name:a.id}return b}function callibri_send_feedback_form(a,b){var c=_callibri.feedback_settings[b];if(!a||!c)return!1;try{var d=callibri_get_module_feedback_data(a,c),e=d.feedback.email.length>0&&/.{1,}@.{1,}\..{1,}/.test(d.feedback.email),f=!1;if(d.feedback.phone.length>0){var g=d.feedback.phone.replace(/\D/g,"");f=g.length>9&&g.length<13}if(e||f)return d.feedback.form_name=callibriFeedbackFormName(a),callibriMakeRequest("/api/module/contactus",d,callibriFeedbackCallback),!0}catch(a){return!1}return!1}function callibri_check_feedback_form(a,b){var c=["phone","tel","telephone","zayavki[tel]","zvonki[tel]","telefon"],d=["msg","text","message"],e=["name","fio","zayavki[name]"],f={feedback:{name:"",phone:"",email:"",message:"",client_id:b.site_id,number:b.number,session_id:_callibri.session_id}},g="";try{for(var h=a.querySelectorAll("input:not([type='hidden']):not([type='checkbox']),textarea"),i=0;i<h.length;i++)g=h[i].name.toLowerCase(),!f.feedback.email&&h[i].value.indexOf("@")>0&&h[i].value.length<255?f.feedback.email=h[i].value:!f.feedback.phone&&(c.indexOf(g)>-1||h[i].value.replace(/\D/g,"").length>9&&h[i].value.replace(/\D/g,"").length<13||g.match("[\\("+c.toString().replace(/,/gi,"\\)|\\(")+"\\)]"))?f.feedback.phone=h[i].value.replace(/\D/g,""):!f.feedback.name&&(e.indexOf(g)>-1||g.match("("+e.toString().replace(/,/gi,")|(")+")"))?f.feedback.name=h[i].value:!f.feedback.message&&(d.indexOf(g)>-1||h[i].tagName.toLowerCase().match("textarea"))&&(f.feedback.message=h[i].value);if(0===f.feedback.message.length)try{f.feedback.message=(a.querySelectorAll("input[type='submit']")[0]||a.querySelectorAll("button")[0]).name}catch(a){}if(f.feedback.email.length>0||f.feedback.phone.length>0)return f.feedback.page=document.location.protocol+"//"+document.location.host+document.location.pathname,f.feedback.form_name=callibriFeedbackFormName(a),callibriMakeRequest("/api/module/contactus",f,callibriFeedbackCallback),!0}catch(a){return callibriSendError(a,"callibriFormOnSubmit"),!1}return!1}function callibriFormsOnSubmit(a,b){function c(a){if(13==a.keyCode||"keydown"!=a.type)try{callibri_check_feedback_form(a.target.form||document.querySelectorAll(".modal.in")[0]||(this.parentNode.className.indexOf("submit")<0?a.target.parentNode:a.target.parentNode.parentNode),b)&&("submit"==a.type?a.target.removeEventListener("submit",arguments.callee,!0):(a.target.removeEventListener("keydown",arguments.callee,!0),_callibri.mobile.isMobile&&(a.target.removeEventListener("click",arguments.callee,!0),a.target.removeEventListener("touchstart",arguments.callee,!0)),a.target.removeEventListener("mousedown",arguments.callee,!0)))}catch(a){}}try{for(var d=document.querySelectorAll('form:not([data_form^="callibri"]):not([id^="callibri"]),.modal,#forma'),e=0;e<d.length;e++)if("FORM"===d[e].tagName||0===d[e].querySelectorAll("form").length||"forma"===d[e].id){var f=d[e].querySelectorAll("input[type='submit']")[0]||d[e].querySelectorAll("button[type='submit']")[0]||d[e].querySelectorAll("button[id*=submit]")[0]||d[e].querySelectorAll("button")[0]||d[e].querySelectorAll(".button")[0]||d[e].querySelectorAll("input[name='submit']")[0]||void 0,g=d[e].querySelectorAll("input[type='password']");void 0!==f&&f.style.cssText.match("display: none")&&(f=void 0),void 0===f&&"forma"===d[e].id&&(f=d[e].querySelectorAll(".submit input[type='button']")[0]),void 0===f&&(f=d[e].querySelector('a[class*="submit"],a[id*="submit"],input[class*="submit"],input[id*="submit"]')||void 0),d[e].action&&d[e].action.split("?")[0].indexOf("search")>-1&&(f=void 0),void 0===f||f.dataset.callibri_parse_form||0!==g.length?0===g.length&&d[e].action&&-1===d[e].action.indexOf("search")&&d[e].addEventListener("submit",c,!0):(f.dataset.callibri_parse_form=!0,f.addEventListener("keydown",c,!0),_callibri.mobile.isMobile&&(f.addEventListener("click",c,!0),f.addEventListener("touchstart",c,!0)),f.addEventListener("mousedown",c,!0)),"undefined"!=typeof pwebBoxes&&void 0!==pwebBoxes[e]&&(pwebBoxes[e].options.onComplete=function(){"post"==this.Form[0].method.toLowerCase()&&callibri_check_feedback_form(this.Form[0],b)})}}catch(a){callibriSendError(a,"callibriFormsOnSubmit")}}function callibriSetValueToBlocksByClass(a,b,c){try{if(void 0!==b&&""!==b){b.match(/^(7800)|(7804)/)&&(c=c.replace("+7","8"));var d=b;b=b.substr(1);try{b=callibriFormatPhone(b,c)}catch(a){b=callibriFormatPhone(b,"+7 (#{XXX}) #{XXX}-#{XX}-#{XX}")}for(var e=document.querySelectorAll(a),f=0;f<e.length;f++)"IMG"===e[f].tagName?callibriChangeImage(e[f],b,!1):(a.match(/\[href\*=tel\]/)||(e[f].innerHTML=b),"A"===e[f].tagName&&e[f].href.match(/^tel\:/i)&&(e[f].href="tel:+"+d))}}catch(a){}}function callibriChangeImage(a,b,c){var d=new Image,e=_callibri.site_id.toString()+"_"+_callibri.number+"_"+(c?"default":a.id)+".png",f=document.location.protocol+"//"+_callibri.server_host+"/customs_sites_imgs/"+e;d.onerror=d.onabort=function(){c?a.innerHTML=b:callibriChangeImage(a,b,!0)},d.onload=function(){a.src=f,a.alt=b},d.src=f}function callibriFormatPhone(a,b){for(var c="",d=b.match(/#{(X)+}/gi),e=b,f=0;f<d.length;f++)e=e.replace(/#{(X)+}/i,"$$"+(f+1)),c+="("+d[f].slice(2,-1).replace(/(X)/gi,"\\d")+")";return c=new RegExp(c),a.replace(c,e)}function callibriBindReady(a){function b(){checkIE8_9_10_11()?callibriGetLibrary("//cdn.callibri.ru/ie_polyfills.min.js",a):a()}function c(){try{document.documentElement.doScroll("left"),b()}catch(a){setTimeout(c,10)}}if("loading"!==document.readyState)return void b();if(document.addEventListener)document.addEventListener("DOMContentLoaded",b,!1);else if(document.attachEvent){var d;try{d=null!==window.frameElement}catch(a){}document.documentElement.doScroll&&!d&&c(),document.attachEvent("onreadystatechange",function(){"interactive"===document.readyState&&b()})}else if(window.addEventListener)window.addEventListener("load",b,!1);else if(window.attachEvent)window.attachEvent("onload",b);else{var e=window.onload;window.onload=function(){e&&e(),b()}}}function extend(a,b){for(var c in b)a[c]=b[c];return a}function checkIE8_9(){return!!navigator.userAgent.match(/(MSIE 9\.0)|(MSIE 8\.0)/)}function checkIE8_9_10_11(){return!!(navigator.userAgent.match(/(MSIE 10\.0)|(MSIE 9\.0)|(MSIE 8\.0)/)||navigator.userAgent.indexOf("Trident/7.0")>-1)}function checkIE8_9_10(){return!!navigator.userAgent.match(/(MSIE 10\.0)|(MSIE 9\.0)|(MSIE 8\.0)/)}function checkIE8(){return!!navigator.userAgent.match(/(MSIE 8\.0)/)}function check_IE10_11_Edge(){return!!(navigator.userAgent.match(/(MSIE 10\.0)/)||navigator.userAgent.indexOf("Edge")>-1||navigator.userAgent.indexOf("Trident/7.0")>-1)}function callibriSendError(a,b,c,d){_callibri.debug&&window.console.log(a)}function callibriReachGoal(a,b){for(var c,d=a.length,e=0;e<d;e++)c=a[e],b.reachGoal(c.name)}function callibri_pusher_reach_goal(a,b){a._chat_channel.bind("client-reachGoal",function(c){var d="yaCounter"+_callibri.metrika.counter_id;callibriReachGoal(c,window[d]),callibriSetCookie("callibri_metrika",!0),a._chat_channel.unbind("client-reachGoal",function(){}),b&&a._pusher.unsubscribe("presence-"+_callibri.session_id.toString())})}function callibriFeedbackCallback(){if(_callibri.metrika){var a=function(){var a={};a=_callibri.chat_widget&&_callibri.chat_widget._pusher?_callibri.chat_widget:callibri_pusher_subscribe(a),callibri_pusher_reach_goal(a,!0)};"undefined"==typeof Pusher?callibriGetLibrary("//js.pusher.com/3.0/pusher.min.js",a,"Pusher"):a()}}function callibriGoalOW(){if(_callibri.ga_goals&&_callibri.ga_goals.widget_open||_callibri.metrika&&_callibri.metrika.widget_open){var a=document.querySelectorAll("#callibri-module-area img[onclick*=showDiv],#callibri-module-area svg[onclick*=showDiv]");if(a.length>0){var b,c,d=a.length;for(b=0;b<d;b++)c=a[b],c.addEventListener("click",function(a){if(_callibri.ga_goals&&_callibri.ga_goals.widget_open)try{(0,window[window.GoogleAnalyticsObject||"ga"])("send","event","Callibri",_callibri.metrika.widget_open,{})}catch(a){}if(_callibri.metrika&&_callibri.metrika.widget_open)try{window["yaCounter"+_callibri.metrika.counter_id].reachGoal(_callibri.metrika.widget_open)}catch(a){}event.target.removeEventListener("click",arguments.callee,!0)})}}}function getMetrikaClientID(a){if(_callibri.use_guid||a){var b;try{if(void 0===(b=_callibri.ya_client_id)||!b){var c=callibriGetYaCounter();c&&(b=c.getClientID(),_callibri.ya_client_id=b)}}catch(a){}return void 0===b?null:b}return null}function callibriGetGaClientID(a){if(_callibri.use_guid||a){var b;try{b=ga.getAll()[0].get("clientId"),_callibri.ga_client_id=b}catch(a){}return void 0===b?null:b}return null}function callibriGetYaCounter(){if(!_callibri.metrika)return null;var a=null;if(_callibri.metrika&&_callibri.metrika.counter_id&&(a="yaCounter"+_callibri.metrika.counter_id,"object"!=typeof window[a]&&(a=null)),!a)for(var b in window)if(b.match("yaCounter")){a=b;break}var c=a?window[a]:null;return c&&"object"==typeof c&&"function"==typeof c.params?c:null}function callibriGetGuid(a){var b=callibriGetCookie(_callibri.cookie_prefix+"guid_type_callibri");if(_callibri.use_guid&&"complete"!=b){var c={sessionid:_callibri.session_id,client_id:_callibri.site_id,number:_callibri.number,session_uniq:_callibri.key},d=window[window.GoogleAnalyticsObject||"ga"];if("only_ya"!=b&&void 0!==d&&d.loaded&&"function"==typeof d.getAll){_callibri.ga_client_id=d.getAll()[0].get("clientId"),c.ga_client_id=_callibri.ga_client_id;try{if(_callibri.ga_goals&&_callibri.ga_goals.dimension){var e="dimension"+_callibri.ga_goals.dimension.toString(),f="dimension"+(_callibri.ga_goals.dimension+1).toString();d("set",e,_callibri.guid_key),d("set",f,_callibri.ga_client_id),d("set","&uid",_callibri.ga_client_id)}}catch(a){console.log(a)}}if("only_ga"!=b){var g=callibriGetYaCounter();if(g&&"object"==typeof g&&"function"==typeof g.params&&(_callibri.ya_client_id=g.getClientID(),c.ya_client_id=_callibri.ya_client_id,_callibri.metrika))try{g.params("callibri_session",_callibri.guid_key.toString())}catch(a){console.log(a)}}if(_callibri.ga_client_id&&_callibri.ya_client_id)return;if(void 0===a&&(a=0,callibriGoalOW()),a>150)return void callibriSetCookie(_callibri.cookie_prefix+"guid_type_callibri","complete");a+=1,setTimeout(function(){callibriGetGuid(a)},2e3)}}function callibriChangeEmails(){if(_callibri.module_settings&&_callibri.module_settings.email_elements&&_callibri.session_id){var a,b,c,d,e,f,g=_callibri.site_id.toString()+"-"+Number(_callibri.session_id).toString(36)+"@dr-mail.com",h=_callibri.module_settings.email_elements.length;for(e=0;e<h;e++)for(d=_callibri.module_settings.email_elements[e],a=document.querySelectorAll(d),c=a.length,f=0;f<c;f++)b=a[f],b.innerText=b.innerText.replace(/\S+@\S+/gi,g),"A"===b.tagName&&b.href.indexOf("mailto")>-1&&(b.href="mailto:"+g)}}function callibriGetLibrary(a,b,c){var d="function"==typeof requirejs&&"function"==typeof define;_callibri.module_settings&&_callibri.module_settings.norequirejs&&(d=!1);var e=callibriGetCookie("callibri_requirejs");if(d)requirejs([a],function(a){window[c]=a,b()}),callibriSetCookie("callibri_requirejs","true");else{if(e)return void setTimeout(function(){callibriGetLibrary(a,b,c)},5e3);var f=document.getElementsByTagName("head")[0],g=document.createElement("script");g.setAttribute("type","text/javascript"),g.setAttribute("src",a),g.setAttribute("name",c),g.setAttribute("charset","utf-8"),window["done_script_"+c]=!1,g.onload=g.onreadystatechange=function(){var a="done_script_"+this.getAttribute("name");window[a]||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(window[a]=!0,b())},f.appendChild(g)}}function callibriGetRequest(a,b){var c=XhrRequest();c&&(c.open("GET",a,!0),b&&(c.onreadystatechange=function(){b(c)}),c.send())}function callibriLoadContentCallback(a,b){if(a){callibriBindReady(function(){callibriHandleResponse(a,b)})}}function callibriAfterResponse(){if(!_callibri.feedback_send){_callibri.feedback_send=!0;var a=callibriGetItemLocalStorage("callibri_feedbacks");if(a&&_callibri.init){a=JSON.parse(a);for(var b,c,d,e,f=0;f<a.length;f++){c=a[f].split("-;-"),b={feedback:{session_id:_callibri.session_id,number:_callibri.number}};for(var g=0;g<c.length;g++)feed=c[g].split("-:-"),feed.length>0&&(d=feed[0],e=feed[1],b.feedback[d]=e);callibriRemoveElementItemLocalStorage("callibri_feedbacks",a[f]),callibriMakeRequest("/api/module/contactus",b,callibriFeedbackCallback)}callibriSetItemLocalStorage("callibri_feedbacks","")}}if(_callibri.mobile.isMobile){var h=new Event("orientationchange");window.dispatchEvent(h)}}function callibriInit(a){try{if(a){if("undefined"!=typeof callibri_init_script)return;callibri_init_script=!0}_callibri.mobile={},_callibri.mobile.isMobile=!1,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Mobi/i.test(navigator.userAgent)&&(_callibri.mobile.isMobile=!0,_callibri.mobile.iPhone=!!/iPhone/i.test(navigator.userAgent)),_callibri.cookie_prefix="v1_",_callibri.server_host||(_callibri.server_host="callibri.ru"),_callibri.cdn_host||(_callibri.cdn_host="cdn.callibri.ru"),_callibri.module_host||(_callibri.module_host="module.callibri.ru");var b,c,d=0;b=_callibri.objects.callibri,b.oid="callibri",b.format||(b.format="+7 (#{XXX}) #{XXX}-#{XX}-#{XX}"),b.block_class||(b.block_class="callibri_phone");var e,f=callibriGetCookie(_callibri.cookie_prefix+"sessions_callibri")||null,g=callibriGetCookie(_callibri.cookie_prefix+"data"),h=callibriGetCookie(_callibri.cookie_prefix+"ga_client_id"),i=new RegExp("^https?://"+document.domain),j=callibriGetCookie(_callibri.cookie_prefix+"referrer_callibri"),k=document.referrer,l=window.location.href,m=document.location.search&&document.location.search.match(/utm_referrer=(.+)(&|$)/);if(m)try{k=decodeURIComponent(m[1])}catch(a){k=document.referrer}var n=!1===j;if(j||(j=k,callibriSetCookie(_callibri.cookie_prefix+"referrer_callibri",j)),callibriGetCookie(_callibri.cookie_prefix+"landing_callibri")!=l&&callibriSetCookie(_callibri.cookie_prefix+"landing_callibri",l),k&&k.match(i)){if(!f&&!1===n)return}else j==k&&l==window.location.href||f&&j!=k&&(g="",j=k,l=window.location.href,callibriSetCookie(_callibri.cookie_prefix+"data","",void 0,!0),callibriSetCookie(_callibri.cookie_prefix+"referrer_callibri",j));e=document.location.search,document.location.hash&&document.location.hash.match("=")&&(e+=document.location.hash.replace(/^#/,e?"&":"?"));if(!j&&(navigator.userAgent.toLowerCase().match("(rambler)|(googlebot)|(aport)|(yahoo)|(msnbot)|(turtle)|(mail.ru)|(omsktele)|(yetibot)|(picsearch)|(sape.bot)|(sape_context)|(gigabot)|(snapbot)|(alexa.com)|(megadownload.net)|(askpeter.info)|(igde.ru)|(ask.com)|(qwartabot)|(yanga.co.uk)|(scoutjet)|(similarpages)|(oozbot)|(shrinktheweb.com)|(aboutusbot)|(followsite.com)|(dataparksearch)|(google-sitemaps)|(appEngine-google)|(feedfetcher-google)|(liveinternet.ru)|(xml-sitemaps.com)|(agama)|(metadatalabs.com)|(h1.hrn.ru)|(googlealert.com)|(seo-rus.com)|(yaDirectBot)|(yandeG)|(yandex)|(yandexSomething)|(Copyscape.com)|(AdsBot-Google)|(domaintools.com)|(Nigma.ru)|(bing.com)|(dotnetdotcom)|(Google Page Speed)".toLowerCase())||e&&e.match(/(\{STYPE\})|(\{SRC\})|(\{PTYPE\})|(\{POS\})|(\{PARAM127\})|(\{PHRASE\})/)))return;try{h||(h=ga.getAll()[0].get("clientId")),_callibri.ga_client_id=h}catch(a){}if(_callibri.exists_url=!!callibriGetItemLocalStorage("callibri_hooks_urls")||null,_callibri.exists_url)try{var o=callibriGetItemLocalStorage("callibri_hooks_urls_timestamp"),p=new Date,q=new Date(o),d=q.getTime?(p-q)/1e3/60:60;_callibri.exists_url=d<60||null}catch(a){_callibri.exists_url=null}c={uid:document.domain,session_id:f,search:e,referrer:j,ga_client_id:h||null,landing:document.location.href,exists_url:_callibri.exists_url,exists_cookie_lid_catcher:!!callibriGetCookie("callibri_catcher_was_shown")||null};try{if(!g&&supports_callibri_storage()&&(g=localStorage.getItem("callibri")),g){json=JSON.parse(g);var p=new Date,q=new Date(json.expire_date);d=q.getTime?(p-q)/1e3/60:10,_callibri.load_chat_history=callibriGetCookie(_callibri.cookie_prefix+"callibri_chat_history")}else _callibri.load_chat_history=null!==c.session_id;var r=a?callibriLoadContentCallback:callibriHandleResponse;if(g&&d<10)if(json.data.module_settings)r(g,200);else{var s;if(supports_callibri_storage()&&(s=localStorage.getItem("callibri_module_settings")),s)json.data.module_settings=JSON.parse(s),g=JSON.stringify(json),r(g,200);else{var t=function(a){var b=callibriGetCookie(_callibri.cookie_prefix+"data");if(a&&b){json=JSON.parse(b);try{localStorage.setItem("callibri_module_settings",a)}catch(a){}json.data.module_settings=JSON.parse(a),b=JSON.stringify(json)}if(b){
("complete"!==document.readyState?callibriLoadContentCallback:callibriHandleResponse)(b,200)}};callibriMakeRequest("/api/module/site_settings",{site_id:json.data.site_id,session_id:json.data.key},t)}}else{if(callibriSetCookie(_callibri.cookie_prefix+"data","",void 0,!0),supports_callibri_storage())try{localStorage.removeItem("callibri"),localStorage.removeItem("callibri_module_settings")}catch(a){_callibri.localStorage_off=!0}callibriMakeRequest("/api/module/number",c,r,"application/json",_callibri.module_host,6e4)}}catch(a){callibriMakeRequest("/api/module/number",c,r,"application/json",_callibri.module_host,6e4)}}catch(a){void 0!==console?console.log(a.stack):window.console.log(a),void 0!==console?callibriSendError(a.stack,"callibriInit"):callibriSendError(a,"callibriInit")}}if(!_callibri)var _callibri={objects:{callibri:{block_class:"callibri_phone",format:"+7 (#{XXX}) #{XXX}-#{XX}-#{XX}"}}};_callibri.objects||(_callibri.objects={callibri:{block_class:"callibri_phone",format:"+7 (#{XXX}) #{XXX}-#{XX}-#{XX}"}}),callibriInit(!0);